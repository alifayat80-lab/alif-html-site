<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>EALA80 — User Panel</title>
<style>
:root{--bg:#fff3b0;--muted:#222}
body{margin:0;font-family:Inter,Arial;background:var(--bg);color:var(--muted);padding:18px}
.wrap{max-width:980px;margin:0 auto}
.header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.logo{font-weight:800;font-size:20px}
.card{background:rgba(255,255,255,0.95);border-radius:12px;padding:14px;margin-bottom:12px;border:1px solid #1112}
.small{font-size:13px;color:#444}
.table{width:100%;border-collapse:collapse}
.table th,.table td{padding:8px;border-bottom:1px solid #f1f1f1}
.center{text-align:center}
@media(max-width:760px){body{padding:12px}}
</style>
</head>
<body>
<div class="wrap">
  <div class="header card">
    <div class="logo" id="siteTitle">EALA80</div>
    <div style="margin-left:auto"><a href="admin.html" target="_blank">Admin</a></div>
  </div>

  <div class="card">
    <h3>Products</h3>
    <div id="productsArea"></div>
  </div>

  <div class="card">
    <h3>Your Balance</h3>
    <div id="balanceArea" class="small"></div>
  </div>

  <div class="card">
    <h3>Invite Codes</h3>
    <div id="inviteArea" class="small"></div>
  </div>

  <div class="card center small">This user panel reads the same shared data as admin (localStorage). To get real-time across devices enable Firebase per README.</div>
</div>

<script>
const STORAGE_KEY = 'eala_full_state_v1';
function loadState(){ try{return JSON.parse(localStorage.getItem(STORAGE_KEY))||{}}catch(e){return{}} }
let state = loadState();
if(!state.site) state.site={title:'EALA80'};
document.getElementById('siteTitle').innerText = state.site.title || 'EALA80';

function renderProducts(){
  const el = document.getElementById('productsArea');
  if(!state.products || state.products.length===0){ el.innerHTML='<div class="small">No products</div>'; return; }
  let html = '<table class="table"><thead><tr><th>Product</th><th>Price(USD)</th><th>Stock</th></tr></thead><tbody>';
  state.products.forEach(p=>{
    html += `<tr><td>${p.title}</td><td>$${p.price}</td><td>${p.stock}</td></tr>`;
  });
  html += '</tbody></table>';
  el.innerHTML = html;
}
function renderBalance(){
  const u = state.users && state.users[0];
  if(!u){ document.getElementById('balanceArea').innerText = 'No user'; return; }
  document.getElementById('balanceArea').innerText = u.username + ' — Balance: $' + (u.balance||0);
}
function renderInvites(){
  const inv = state.invites && state.invites.length? state.invites.map(i=>i.code).join(', '): 'No invites';
  document.getElementById('inviteArea').innerText = inv;
}

renderProducts(); renderBalance(); renderInvites();
</script>
</body>
</html>
